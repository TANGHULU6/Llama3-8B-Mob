
2024-09-16 13:53:21,596 INFO Initializing model and tokenizer...
==((====))==  Unsloth: Fast Llama patching release 2024.7
   \\   /|    GPU: NVIDIA RTX A6000. Max memory: 47.536 GB. Platform = Linux.
O^O/ \_/ \    Pytorch: 2.3.0+cu121. CUDA = 8.6. CUDA Toolkit = 12.1.
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.26.post1. FA2 = False]
 "-____-"     Free Apache license: http://github.com/unslothai/unsloth
Unsloth: unsloth/llama-3-8b-Instruct-bnb-4bit can only handle sequence lengths of at most 8192.
But with kaiokendev's RoPE scaling of 6.104, it can be magically be extended to 50000!
Unsloth 2024.7 patched 32 layers with 32 QKV layers, 32 O layers and 32 MLP layers.
2024-09-16 13:53:30,458 INFO Model and tokenizer initialized successfully.
2024-09-16 13:53:30,459 INFO Starting inference from index 2100 to 2399 on dataset datasetC_test_17000-19999.json
2024-09-16 13:53:30,459 INFO Loading dataset from datasetC_test_17000-19999.json...
2024-09-16 13:53:31,110 INFO Dataset loaded with 3000 conversations.
2024-09-16 13:53:31,112 INFO Loaded dataset datasetC_test_17000-19999.json with 3000 conversations
2024-09-16 13:53:31,114 INFO Selected subset of dataset from index 2100 to 2400
Map: 100%|███████████████████████████████████████████████████████████████████| 300/300 [00:00<00:00, 4788.44 examples/s]
2024-09-16 13:53:31,181 INFO Applied formatting prompts function to dataset
2024-09-16 13:53:31,181 INFO Total conversations to process: 300
2024-09-16 13:53:31,182 INFO Processing conversation 2100/2399
2024-09-16 13:53:31,196 INFO Input sequence length: torch.Size([1, 6765])
2024-09-16 13:54:46,393 ERROR Exception in conversation user 19100: 'tuple' object has no attribute 'split'
2024-09-16 13:54:46,394 ERROR Attempt 1/3 failed
2024-09-16 13:54:47,414 INFO Input sequence length: torch.Size([1, 6765])
2024-09-16 13:56:03,759 ERROR Exception in conversation user 19100: 'tuple' object has no attribute 'split'
2024-09-16 13:56:03,760 ERROR Attempt 2/3 failed
2024-09-16 13:56:04,779 INFO Input sequence length: torch.Size([1, 6765])
2024-09-16 13:57:20,748 ERROR Exception in conversation user 19100: 'tuple' object has no attribute 'split'
2024-09-16 13:57:20,748 ERROR Attempt 3/3 failed
2024-09-16 13:57:20,748 ERROR Failed to process conversation user 19100 after 3 attempts
2024-09-16 13:57:20,749 INFO Processing conversation 2101/2399
2024-09-16 13:57:20,758 INFO Input sequence length: torch.Size([1, 5173])
2024-09-16 13:58:40,785 ERROR Exception in conversation user 19099: 'tuple' object has no attribute 'split'
2024-09-16 13:58:40,786 ERROR Attempt 1/3 failed
2024-09-16 13:58:41,804 INFO Input sequence length: torch.Size([1, 5173])
2024-09-16 14:00:02,026 ERROR Exception in conversation user 19099: 'tuple' object has no attribute 'split'
2024-09-16 14:00:02,027 ERROR Attempt 2/3 failed
2024-09-16 14:00:03,045 INFO Input sequence length: torch.Size([1, 5173])
2024-09-16 14:01:22,921 ERROR Exception in conversation user 19099: 'tuple' object has no attribute 'split'
2024-09-16 14:01:22,921 ERROR Attempt 3/3 failed
2024-09-16 14:01:22,921 ERROR Failed to process conversation user 19099 after 3 attempts
2024-09-16 14:01:22,922 INFO Processing conversation 2102/2399
2024-09-16 14:01:22,930 INFO Input sequence length: torch.Size([1, 4181])
2024-09-16 14:02:42,868 ERROR Exception in conversation user 19097: 'tuple' object has no attribute 'split'
2024-09-16 14:02:42,868 ERROR Attempt 1/3 failed
2024-09-16 14:02:43,884 INFO Input sequence length: torch.Size([1, 4181])
2024-09-16 14:04:02,610 ERROR Exception in conversation user 19097: 'tuple' object has no attribute 'split'
2024-09-16 14:04:02,610 ERROR Attempt 2/3 failed
2024-09-16 14:04:03,627 INFO Input sequence length: torch.Size([1, 4181])
2024-09-16 14:05:22,185 ERROR Exception in conversation user 19097: 'tuple' object has no attribute 'split'
2024-09-16 14:05:22,186 ERROR Attempt 3/3 failed
2024-09-16 14:05:22,186 ERROR Failed to process conversation user 19097 after 3 attempts
2024-09-16 14:05:22,187 INFO Processing conversation 2103/2399
2024-09-16 14:05:22,197 INFO Input sequence length: torch.Size([1, 6453])
2024-09-16 14:07:46,940 ERROR Exception in conversation user 19102: 'tuple' object has no attribute 'split'
2024-09-16 14:07:46,940 ERROR Attempt 1/3 failed
2024-09-16 14:07:47,959 INFO Input sequence length: torch.Size([1, 6453])
2024-09-16 14:10:10,079 ERROR Exception in conversation user 19102: 'tuple' object has no attribute 'split'
2024-09-16 14:10:10,079 ERROR Attempt 2/3 failed
2024-09-16 14:10:11,098 INFO Input sequence length: torch.Size([1, 6453])
2024-09-16 14:12:33,836 ERROR Exception in conversation user 19102: 'tuple' object has no attribute 'split'
2024-09-16 14:12:33,836 ERROR Attempt 3/3 failed
2024-09-16 14:12:33,836 ERROR Failed to process conversation user 19102 after 3 attempts
2024-09-16 14:12:33,837 INFO Processing conversation 2104/2399
2024-09-16 14:12:33,851 INFO Input sequence length: torch.Size([1, 8245])
2024-09-16 14:16:46,566 ERROR Exception in conversation user 19101: 'tuple' object has no attribute 'split'
2024-09-16 14:16:46,566 ERROR Attempt 1/3 failed
2024-09-16 14:16:47,588 INFO Input sequence length: torch.Size([1, 8245])
2024-09-16 14:21:01,056 ERROR Exception in conversation user 19101: 'tuple' object has no attribute 'split'
2024-09-16 14:21:01,057 ERROR Attempt 2/3 failed
2024-09-16 14:21:02,078 INFO Input sequence length: torch.Size([1, 8245])
2024-09-16 14:25:15,672 ERROR Exception in conversation user 19101: 'tuple' object has no attribute 'split'
2024-09-16 14:25:15,673 ERROR Attempt 3/3 failed
2024-09-16 14:25:15,673 ERROR Failed to process conversation user 19101 after 3 attempts
2024-09-16 14:25:15,674 INFO Processing conversation 2105/2399
2024-09-16 14:25:15,682 INFO Input sequence length: torch.Size([1, 4669])
2024-09-16 14:26:46,595 ERROR Exception in conversation user 19096: 'tuple' object has no attribute 'split'
2024-09-16 14:26:46,596 ERROR Attempt 1/3 failed
2024-09-16 14:26:47,612 INFO Input sequence length: torch.Size([1, 4669])
2024-09-16 14:28:16,019 ERROR Exception in conversation user 19096: 'tuple' object has no attribute 'split'
2024-09-16 14:28:16,020 ERROR Attempt 2/3 failed
2024-09-16 14:28:17,036 INFO Input sequence length: torch.Size([1, 4669])
2024-09-16 14:29:45,627 ERROR Exception in conversation user 19096: 'tuple' object has no attribute 'split'
2024-09-16 14:29:45,628 ERROR Attempt 3/3 failed
2024-09-16 14:29:45,628 ERROR Failed to process conversation user 19096 after 3 attempts
2024-09-16 14:29:45,629 INFO Processing conversation 2106/2399
2024-09-16 14:29:45,636 INFO Input sequence length: torch.Size([1, 3693])
2024-09-16 14:30:38,994 ERROR Exception in conversation user 19114: 'tuple' object has no attribute 'split'
2024-09-16 14:30:38,994 ERROR Attempt 1/3 failed
2024-09-16 14:30:40,010 INFO Input sequence length: torch.Size([1, 3693])
2024-09-16 14:31:32,325 ERROR Exception in conversation user 19114: 'tuple' object has no attribute 'split'
2024-09-16 14:31:32,325 ERROR Attempt 2/3 failed
2024-09-16 14:31:33,342 INFO Input sequence length: torch.Size([1, 3693])
2024-09-16 14:32:25,968 ERROR Exception in conversation user 19114: 'tuple' object has no attribute 'split'
2024-09-16 14:32:25,968 ERROR Attempt 3/3 failed
2024-09-16 14:32:25,968 ERROR Failed to process conversation user 19114 after 3 attempts
2024-09-16 14:32:25,969 INFO Processing conversation 2107/2399
2024-09-16 14:32:25,977 INFO Input sequence length: torch.Size([1, 3829])
2024-09-16 14:33:51,014 ERROR Exception in conversation user 19111: 'tuple' object has no attribute 'split'
2024-09-16 14:33:51,015 ERROR Attempt 1/3 failed
