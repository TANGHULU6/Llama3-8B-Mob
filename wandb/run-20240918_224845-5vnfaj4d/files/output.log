
2024-09-18 22:48:49,581 INFO Initializing model and tokenizer...
==((====))==  Unsloth: Fast Llama patching release 2024.7
   \\   /|    GPU: NVIDIA RTX A6000. Max memory: 47.536 GB. Platform = Linux.
O^O/ \_/ \    Pytorch: 2.3.0+cu121. CUDA = 8.6. CUDA Toolkit = 12.1.
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.26.post1. FA2 = False]
 "-____-"     Free Apache license: http://github.com/unslothai/unsloth
Unsloth: unsloth/llama-3-8b-Instruct-bnb-4bit can only handle sequence lengths of at most 8192.
But with kaiokendev's RoPE scaling of 6.104, it can be magically be extended to 50000!
Unsloth 2024.7 patched 32 layers with 32 QKV layers, 32 O layers and 32 MLP layers.
2024-09-18 22:48:59,778 INFO Model and tokenizer initialized successfully.
2024-09-18 22:48:59,780 INFO Starting inference from index 2836 to 2845 on dataset datasetC_test_17000-19999.json
2024-09-18 22:48:59,781 INFO Loading dataset from datasetC_test_17000-19999.json...
2024-09-18 22:49:00,535 INFO Dataset loaded with 3000 conversations.
2024-09-18 22:49:00,538 INFO Loaded dataset datasetC_test_17000-19999.json with 3000 conversations
2024-09-18 22:49:00,539 INFO Selected subset of dataset from index 2836 to 2846
Map: 100%|██████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 357.16 examples/s]
2024-09-18 22:49:00,571 INFO Applied formatting prompts function to dataset
2024-09-18 22:49:00,571 INFO Total conversations to process: 10
2024-09-18 22:49:00,572 INFO Processing conversation 2836/2845
2024-09-18 22:49:00,589 INFO Input sequence length: torch.Size([1, 5205])
2024-09-18 22:51:37,744 INFO User 19836 processed in 157.17s
2024-09-18 22:51:37,749 INFO Processing conversation 2837/2845
2024-09-18 22:51:37,760 INFO Input sequence length: torch.Size([1, 3693])
**************************************************Result Report**************************************************
geobleu: 1.4562516441905911e-294
dtw: 5588.083711188897
*****************************************************************************************************************
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6669.346208716945
*****************************************************************************************************************
2024-09-18 22:55:08,186 INFO User 19840 processed in 210.44s
2024-09-18 22:55:08,188 INFO Processing conversation 2838/2845
2024-09-18 22:55:08,199 INFO Input sequence length: torch.Size([1, 3101])
2024-09-18 22:58:21,383 INFO User 19838 processed in 193.19s
2024-09-18 22:58:21,386 INFO Processing conversation 2839/2845
2024-09-18 22:58:21,403 INFO Input sequence length: torch.Size([1, 3685])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6418.223000979496
*****************************************************************************************************************
2024-09-18 23:00:00,871 ERROR Exception in conversation user 19841: The length doesn't match between the generated and reference trajectories.
2024-09-18 23:00:00,871 ERROR Attempt 1/3 failed
2024-09-18 23:00:01,891 INFO Input sequence length: torch.Size([1, 3685])
**************************************************Result Report**************************************************
2024-09-18 23:01:40,058 ERROR Exception in conversation user 19841: The length doesn't match between the generated and reference trajectories.
2024-09-18 23:01:40,058 ERROR Attempt 2/3 failed
**************************************************Result Report**************************************************
2024-09-18 23:01:41,080 INFO Input sequence length: torch.Size([1, 3685])
2024-09-18 23:03:19,619 ERROR Exception in conversation user 19841: The length doesn't match between the generated and reference trajectories.
2024-09-18 23:03:19,619 ERROR Attempt 3/3 failed
2024-09-18 23:03:19,619 ERROR Failed to process conversation user 19841 after 3 attempts
2024-09-18 23:03:19,620 INFO Processing conversation 2840/2845
2024-09-18 23:03:19,633 INFO Input sequence length: torch.Size([1, 5805])
**************************************************Result Report**************************************************
2024-09-18 23:07:04,932 INFO User 19842 processed in 225.31s
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6383.70147609915
*****************************************************************************************************************
2024-09-18 23:07:04,935 INFO Processing conversation 2841/2845
2024-09-18 23:07:04,957 INFO Input sequence length: torch.Size([1, 7061])
2024-09-18 23:15:29,031 INFO User 19837 processed in 504.10s
2024-09-18 23:15:29,035 INFO Processing conversation 2842/2845
2024-09-18 23:15:29,060 INFO Input sequence length: torch.Size([1, 8061])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 8482.303398935212
*****************************************************************************************************************
2024-09-18 23:21:40,729 INFO User 19843 processed in 371.69s
2024-09-18 23:21:40,732 INFO Processing conversation 2843/2845
2024-09-18 23:21:40,747 INFO Input sequence length: torch.Size([1, 5733])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 8925.440800775625
*****************************************************************************************************************
2024-09-18 23:23:57,397 INFO User 19845 processed in 136.66s
2024-09-18 23:23:57,402 INFO Processing conversation 2844/2845
2024-09-18 23:23:57,421 INFO Input sequence length: torch.Size([1, 3693])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 9690.51868004357
*****************************************************************************************************************
2024-09-18 23:26:20,100 INFO User 19844 processed in 142.70s
2024-09-18 23:26:20,105 INFO Processing conversation 2845/2845
2024-09-18 23:26:20,133 INFO Input sequence length: torch.Size([1, 7205])
**************************************************Result Report**************************************************
geobleu: 4.61531655059672e-279
dtw: 3441.882224265047
*****************************************************************************************************************
2024-09-18 23:33:35,080 INFO User 19839 processed in 434.98s
2024-09-18 23:33:35,084 INFO Failed conversations: [19841]
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 8037.289375149866
*****************************************************************************************************************
2024-09-18 23:33:35,639 INFO Saving results to generated_datasetC_test_17000-19999_range(2836, 2846).csv.gz
2024-09-18 23:33:35,643 INFO Results saved to generated_datasetC_test_17000-19999_range(2836, 2846).csv.gz