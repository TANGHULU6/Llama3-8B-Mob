==((====))==  Unsloth: Fast Llama patching release 2024.7
   \\   /|    GPU: NVIDIA RTX A6000. Max memory: 47.536 GB. Platform = Linux.
O^O/ \_/ \    Pytorch: 2.3.0+cu121. CUDA = 8.6. CUDA Toolkit = 12.1.
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.26.post1. FA2 = False]
 "-____-"     Free Apache license: http://github.com/unslothai/unsloth
2024-09-18 12:33:08,464 INFO Initializing model and tokenizer...
Unsloth: unsloth/llama-3-8b-Instruct-bnb-4bit can only handle sequence lengths of at most 8192.
But with kaiokendev's RoPE scaling of 6.104, it can be magically be extended to 50000!
Unsloth 2024.7 patched 32 layers with 32 QKV layers, 32 O layers and 32 MLP layers.
2024-09-18 12:33:28,671 INFO Model and tokenizer initialized successfully.
2024-09-18 12:33:28,673 INFO Starting inference from index 1496 to 1505 on dataset datasetC_test_17000-19999.json
2024-09-18 12:33:28,673 INFO Loading dataset from datasetC_test_17000-19999.json...
2024-09-18 12:33:29,387 INFO Dataset loaded with 3000 conversations.
2024-09-18 12:33:29,389 INFO Loaded dataset datasetC_test_17000-19999.json with 3000 conversations
2024-09-18 12:33:29,391 INFO Selected subset of dataset from index 1496 to 1506
Map: 100%|██████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 363.04 examples/s]
2024-09-18 12:33:29,423 INFO Applied formatting prompts function to dataset
2024-09-18 12:33:29,423 INFO Total conversations to process: 10
2024-09-18 12:33:29,424 INFO Processing conversation 1496/1505
2024-09-18 12:33:29,436 INFO Input sequence length: torch.Size([1, 5317])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 3523.81011718702
*****************************************************************************************************************
2024-09-18 12:36:40,074 INFO User 18496 processed in 190.65s
2024-09-18 12:36:40,078 INFO Processing conversation 1497/1505
2024-09-18 12:36:40,096 INFO Input sequence length: torch.Size([1, 5037])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 5529.082381833686
*****************************************************************************************************************
2024-09-18 12:41:34,104 INFO User 18504 processed in 294.03s
2024-09-18 12:41:34,111 INFO Processing conversation 1498/1505
2024-09-18 12:41:34,149 INFO Input sequence length: torch.Size([1, 10925])
2024-09-18 12:53:31,095 INFO User 18499 processed in 716.98s
2024-09-18 12:53:31,099 INFO Processing conversation 1499/1505
2024-09-18 12:53:31,119 INFO Input sequence length: torch.Size([1, 7061])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 9305.899372137092
*****************************************************************************************************************
**************************************************Result Report**************************************************
2024-09-18 13:01:00,837 INFO User 18502 processed in 449.74s
2024-09-18 13:01:00,840 INFO Processing conversation 1500/1505
2024-09-18 13:01:00,873 INFO Input sequence length: torch.Size([1, 13341])
geobleu: 0.0
dtw: 7406.494906714063
*****************************************************************************************************************
**************************************************Result Report**************************************************
2024-09-18 13:22:56,225 INFO User 18497 processed in 1315.38s
2024-09-18 13:22:56,228 INFO Processing conversation 1501/1505
2024-09-18 13:22:56,245 INFO Input sequence length: torch.Size([1, 7229])
geobleu: 0.0
dtw: 13647.352903557496
*****************************************************************************************************************
2024-09-18 13:27:00,098 INFO User 18505 processed in 243.87s
2024-09-18 13:27:00,102 INFO Processing conversation 1502/1505
2024-09-18 13:27:00,139 INFO Input sequence length: torch.Size([1, 15045])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 4454.948612956782
*****************************************************************************************************************
**************************************************Result Report**************************************************
2024-09-18 13:58:29,451 INFO User 18498 processed in 1889.35s
2024-09-18 13:58:29,453 INFO Processing conversation 1503/1505
2024-09-18 13:58:29,471 INFO Input sequence length: torch.Size([1, 5781])
geobleu: 0.0
dtw: 18808.60412406685
*****************************************************************************************************************
2024-09-18 14:03:09,900 INFO User 18500 processed in 280.45s
2024-09-18 14:03:09,905 INFO Processing conversation 1504/1505
2024-09-18 14:03:09,928 INFO Input sequence length: torch.Size([1, 7557])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 5075.610266736594
*****************************************************************************************************************
2024-09-18 14:15:09,206 ERROR Exception in conversation user 18501: Day and time are not the same at step 137, d=67 and t=29 for generated while d=67 and t=33 for reference.
2024-09-18 14:15:09,206 ERROR Attempt 1/3 failed
**************************************************Result Report**************************************************
2024-09-18 14:15:10,232 INFO Input sequence length: torch.Size([1, 7557])
**************************************************Result Report**************************************************
2024-09-18 14:27:18,606 ERROR Exception in conversation user 18501: Day and time are not the same at step 137, d=67 and t=29 for generated while d=67 and t=33 for reference.
2024-09-18 14:27:18,606 ERROR Attempt 2/3 failed
2024-09-18 14:27:19,628 INFO Input sequence length: torch.Size([1, 7557])
2024-09-18 14:39:34,750 ERROR Exception in conversation user 18501: The length doesn't match between the generated and reference trajectories.
2024-09-18 14:39:34,750 ERROR Attempt 3/3 failed
2024-09-18 14:39:34,750 ERROR Failed to process conversation user 18501 after 3 attempts
2024-09-18 14:39:34,751 INFO Processing conversation 1505/1505
2024-09-18 14:39:34,765 INFO Input sequence length: torch.Size([1, 6357])
**************************************************Result Report**************************************************
2024-09-18 14:45:38,715 INFO User 18503 processed in 363.96s
2024-09-18 14:45:38,719 INFO Failed conversations: [18501]
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6563.815423572375
*****************************************************************************************************************
2024-09-18 14:45:39,263 INFO Saving results to generated_datasetC_test_17000-19999_range(1496, 1506).csv.gz
2024-09-18 14:45:39,270 INFO Results saved to generated_datasetC_test_17000-19999_range(1496, 1506).csv.gz