
2024-09-20 09:41:18,873 INFO Initializing model and tokenizer...
==((====))==  Unsloth: Fast Llama patching release 2024.7
   \\   /|    GPU: NVIDIA RTX A6000. Max memory: 47.536 GB. Platform = Linux.
O^O/ \_/ \    Pytorch: 2.3.0+cu121. CUDA = 8.6. CUDA Toolkit = 12.1.
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.26.post1. FA2 = False]
 "-____-"     Free Apache license: http://github.com/unslothai/unsloth
Unsloth: unsloth/llama-3-8b-Instruct-bnb-4bit can only handle sequence lengths of at most 8192.
But with kaiokendev's RoPE scaling of 6.104, it can be magically be extended to 50000!
Unsloth 2024.7 patched 32 layers with 32 QKV layers, 32 O layers and 32 MLP layers.
2024-09-20 09:41:40,741 INFO Model and tokenizer initialized successfully.
2024-09-20 09:41:40,742 INFO Starting inference from index 2836 to 2845 on dataset datasetC_test_17000-19999.json
2024-09-20 09:41:40,742 INFO Loading dataset from datasetC_test_17000-19999.json...
2024-09-20 09:41:41,520 INFO Dataset loaded with 3000 conversations.
2024-09-20 09:41:41,522 INFO Loaded dataset datasetC_test_17000-19999.json with 3000 conversations
2024-09-20 09:41:41,524 INFO Selected subset of dataset from index 2836 to 2846
Map: 100%|██████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 373.06 examples/s]
2024-09-20 09:41:41,558 INFO Applied formatting prompts function to dataset
2024-09-20 09:41:41,558 INFO Total conversations to process: 10
2024-09-20 09:41:41,558 INFO Processing conversation 2836/2845
2024-09-20 09:41:41,572 INFO Input sequence length: torch.Size([1, 5205])
**************************************************Result Report**************************************************
2024-09-20 09:46:47,672 INFO User 19836 processed in 306.11s
2024-09-20 09:46:47,677 INFO Processing conversation 2837/2845
2024-09-20 09:46:47,689 INFO Input sequence length: torch.Size([1, 3693])
geobleu: 1.4562516441905911e-294
dtw: 5537.97561845082
*****************************************************************************************************************
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6670.556379642485
*****************************************************************************************************************
2024-09-20 09:50:37,444 INFO User 19840 processed in 229.77s
2024-09-20 09:50:37,448 INFO Processing conversation 2838/2845
2024-09-20 09:50:37,462 INFO Input sequence length: torch.Size([1, 3101])
2024-09-20 09:54:11,043 INFO User 19838 processed in 213.59s
2024-09-20 09:54:11,045 INFO Processing conversation 2839/2845
2024-09-20 09:54:11,058 INFO Input sequence length: torch.Size([1, 3685])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6408.430831919768
*****************************************************************************************************************
2024-09-20 09:55:58,467 ERROR Exception in conversation user 19841: The length doesn't match between the generated and reference trajectories.
2024-09-20 09:55:58,467 ERROR Attempt 1/3 failed
2024-09-20 09:55:59,479 INFO Input sequence length: torch.Size([1, 3685])
**************************************************Result Report**************************************************
2024-09-20 09:57:47,029 ERROR Exception in conversation user 19841: The length doesn't match between the generated and reference trajectories.
2024-09-20 09:57:47,029 ERROR Attempt 2/3 failed
**************************************************Result Report**************************************************
2024-09-20 09:57:48,049 INFO Input sequence length: torch.Size([1, 3685])
2024-09-20 09:59:35,555 ERROR Exception in conversation user 19841: The length doesn't match between the generated and reference trajectories.
2024-09-20 09:59:35,555 ERROR Attempt 3/3 failed
2024-09-20 09:59:35,556 ERROR Failed to process conversation user 19841 after 3 attempts
2024-09-20 09:59:35,557 INFO Processing conversation 2840/2845
2024-09-20 09:59:35,568 INFO Input sequence length: torch.Size([1, 5805])
**************************************************Result Report**************************************************
**************************************************Result Report**************************************************
2024-09-20 10:03:40,839 INFO User 19842 processed in 245.28s
2024-09-20 10:03:40,844 INFO Processing conversation 2841/2845
2024-09-20 10:03:40,864 INFO Input sequence length: torch.Size([1, 7061])
geobleu: 0.0
dtw: 6388.549632687529
*****************************************************************************************************************
2024-09-20 10:12:34,352 INFO User 19837 processed in 533.51s
2024-09-20 10:12:34,355 INFO Processing conversation 2842/2845
2024-09-20 10:12:34,380 INFO Input sequence length: torch.Size([1, 8061])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 8475.88646777419
*****************************************************************************************************************
2024-09-20 10:19:09,335 INFO User 19843 processed in 394.98s
2024-09-20 10:19:09,337 INFO Processing conversation 2843/2845
2024-09-20 10:19:09,355 INFO Input sequence length: torch.Size([1, 5733])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 8923.529684713634
*****************************************************************************************************************
2024-09-20 10:21:35,225 INFO User 19845 processed in 145.89s
2024-09-20 10:21:35,229 INFO Processing conversation 2844/2845
2024-09-20 10:21:35,246 INFO Input sequence length: torch.Size([1, 3693])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 9693.091708818654
*****************************************************************************************************************
2024-09-20 10:24:07,732 INFO User 19844 processed in 152.50s
2024-09-20 10:24:07,737 INFO Processing conversation 2845/2845
2024-09-20 10:24:07,753 INFO Input sequence length: torch.Size([1, 7205])
**************************************************Result Report**************************************************
geobleu: 4.61531655059672e-279
dtw: 3443.2901133299133
*****************************************************************************************************************
2024-09-20 10:31:54,894 INFO User 19839 processed in 467.16s
2024-09-20 10:31:54,897 INFO Failed conversations: [19841]
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 8447.0117169932
*****************************************************************************************************************
2024-09-20 10:31:55,516 INFO Saving results to generated_datasetC_test_17000-19999_range(2836, 2846).csv.gz
2024-09-20 10:31:55,520 INFO Results saved to generated_datasetC_test_17000-19999_range(2836, 2846).csv.gz