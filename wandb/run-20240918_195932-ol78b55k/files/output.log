
2024-09-18 19:59:36,666 INFO Initializing model and tokenizer...
==((====))==  Unsloth: Fast Llama patching release 2024.7
   \\   /|    GPU: NVIDIA RTX A6000. Max memory: 47.536 GB. Platform = Linux.
O^O/ \_/ \    Pytorch: 2.3.0+cu121. CUDA = 8.6. CUDA Toolkit = 12.1.
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.26.post1. FA2 = False]
 "-____-"     Free Apache license: http://github.com/unslothai/unsloth
Unsloth: unsloth/llama-3-8b-Instruct-bnb-4bit can only handle sequence lengths of at most 8192.
But with kaiokendev's RoPE scaling of 6.104, it can be magically be extended to 50000!
Unsloth 2024.7 patched 32 layers with 32 QKV layers, 32 O layers and 32 MLP layers.
2024-09-18 19:59:45,472 INFO Model and tokenizer initialized successfully.
2024-09-18 19:59:45,473 INFO Starting inference from index 1496 to 1505 on dataset datasetC_test_17000-19999.json
2024-09-18 19:59:45,473 INFO Loading dataset from datasetC_test_17000-19999.json...
2024-09-18 19:59:46,308 INFO Dataset loaded with 3000 conversations.
2024-09-18 19:59:46,311 INFO Loaded dataset datasetC_test_17000-19999.json with 3000 conversations
2024-09-18 19:59:46,312 INFO Selected subset of dataset from index 1496 to 1506
Map: 100%|██████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 285.46 examples/s]
2024-09-18 19:59:46,352 INFO Applied formatting prompts function to dataset
2024-09-18 19:59:46,353 INFO Total conversations to process: 10
2024-09-18 19:59:46,353 INFO Processing conversation 1496/1505
2024-09-18 19:59:46,374 INFO Input sequence length: torch.Size([1, 5317])
2024-09-18 20:00:56,029 INFO User 18496 processed in 69.68s
2024-09-18 20:00:56,032 INFO Processing conversation 1497/1505
2024-09-18 20:00:56,048 INFO Input sequence length: torch.Size([1, 5037])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 3523.7539550495267
*****************************************************************************************************************
2024-09-18 20:02:40,356 INFO User 18504 processed in 104.32s
2024-09-18 20:02:40,361 INFO Processing conversation 1498/1505
2024-09-18 20:02:40,384 INFO Input sequence length: torch.Size([1, 10925])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 5528.071313273988
*****************************************************************************************************************
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 9306.202539856193
*****************************************************************************************************************
2024-09-18 20:06:29,411 INFO User 18499 processed in 229.05s
2024-09-18 20:06:29,416 INFO Processing conversation 1499/1505
2024-09-18 20:06:29,432 INFO Input sequence length: torch.Size([1, 7061])
2024-09-18 20:08:56,668 INFO User 18502 processed in 147.25s
2024-09-18 20:08:56,673 INFO Processing conversation 1500/1505
2024-09-18 20:08:56,698 INFO Input sequence length: torch.Size([1, 13341])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 7405.19608805061
*****************************************************************************************************************
**************************************************Result Report**************************************************
2024-09-18 20:15:52,161 INFO User 18497 processed in 415.49s
2024-09-18 20:15:52,166 INFO Processing conversation 1501/1505
2024-09-18 20:15:52,185 INFO Input sequence length: torch.Size([1, 7229])
geobleu: 0.0
dtw: 13691.957294325297
*****************************************************************************************************************
2024-09-18 20:17:12,586 INFO User 18505 processed in 80.42s
2024-09-18 20:17:12,591 INFO Processing conversation 1502/1505
2024-09-18 20:17:12,618 INFO Input sequence length: torch.Size([1, 15045])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 4455.831098056097
*****************************************************************************************************************
**************************************************Result Report**************************************************
2024-09-18 20:27:22,967 INFO User 18498 processed in 610.38s
2024-09-18 20:27:22,971 INFO Processing conversation 1503/1505
2024-09-18 20:27:22,987 INFO Input sequence length: torch.Size([1, 5781])
geobleu: 0.0
dtw: 18803.476694519002
*****************************************************************************************************************
2024-09-18 20:29:00,916 INFO User 18500 processed in 97.94s
2024-09-18 20:29:00,921 INFO Processing conversation 1504/1505
2024-09-18 20:29:00,937 INFO Input sequence length: torch.Size([1, 7557])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 5076.236274785365
*****************************************************************************************************************
2024-09-18 20:32:47,273 ERROR Exception in conversation user 18501: The length doesn't match between the generated and reference trajectories.
2024-09-18 20:32:47,273 ERROR Attempt 1/3 failed
2024-09-18 20:32:48,292 INFO Input sequence length: torch.Size([1, 7557])
**************************************************Result Report**************************************************
2024-09-18 20:36:34,202 INFO User 18501 processed in 453.28s
2024-09-18 20:36:34,207 INFO Processing conversation 1505/1505
2024-09-18 20:36:34,224 INFO Input sequence length: torch.Size([1, 6357])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 11021.829098589767
*****************************************************************************************************************
2024-09-18 20:38:39,107 INFO User 18503 processed in 124.90s
2024-09-18 20:38:39,108 INFO Failed conversations: []
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6565.1672119375025
*****************************************************************************************************************
2024-09-18 20:38:39,659 INFO Saving results to generated_datasetC_test_17000-19999_range(1496, 1506).csv.gz
2024-09-18 20:38:39,666 INFO Results saved to generated_datasetC_test_17000-19999_range(1496, 1506).csv.gz