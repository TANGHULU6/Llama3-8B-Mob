
2024-09-18 22:39:00,553 INFO Initializing model and tokenizer...
==((====))==  Unsloth: Fast Llama patching release 2024.7
   \\   /|    GPU: NVIDIA RTX A6000. Max memory: 47.536 GB. Platform = Linux.
O^O/ \_/ \    Pytorch: 2.3.0+cu121. CUDA = 8.6. CUDA Toolkit = 12.1.
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.26.post1. FA2 = False]
 "-____-"     Free Apache license: http://github.com/unslothai/unsloth
Unsloth: unsloth/llama-3-8b-Instruct-bnb-4bit can only handle sequence lengths of at most 8192.
But with kaiokendev's RoPE scaling of 6.104, it can be magically be extended to 50000!
Unsloth 2024.7 patched 32 layers with 32 QKV layers, 32 O layers and 32 MLP layers.
2024-09-18 22:39:11,678 INFO Model and tokenizer initialized successfully.
2024-09-18 22:39:11,679 INFO Starting inference from index 1496 to 1505 on dataset datasetC_test_17000-19999.json
2024-09-18 22:39:11,679 INFO Loading dataset from datasetC_test_17000-19999.json...
2024-09-18 22:39:12,320 INFO Dataset loaded with 3000 conversations.
2024-09-18 22:39:12,323 INFO Loaded dataset datasetC_test_17000-19999.json with 3000 conversations
2024-09-18 22:39:12,325 INFO Selected subset of dataset from index 1496 to 1506
Map: 100%|██████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 390.91 examples/s]
2024-09-18 22:39:12,354 INFO Applied formatting prompts function to dataset
2024-09-18 22:39:12,354 INFO Total conversations to process: 10
2024-09-18 22:39:12,355 INFO Processing conversation 1496/1505
2024-09-18 22:39:12,367 INFO Input sequence length: torch.Size([1, 5317])
2024-09-18 22:41:20,283 INFO User 18496 processed in 127.93s
2024-09-18 22:41:20,288 INFO Processing conversation 1497/1505
2024-09-18 22:41:20,303 INFO Input sequence length: torch.Size([1, 5037])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 3523.7064595572037
*****************************************************************************************************************
2024-09-18 22:46:56,265 INFO User 18504 processed in 335.98s
2024-09-18 22:46:56,270 INFO Processing conversation 1498/1505
2024-09-18 22:46:56,298 INFO Input sequence length: torch.Size([1, 10925])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 5527.611128754829
*****************************************************************************************************************
2024-09-18 23:02:25,833 INFO User 18499 processed in 929.56s
2024-09-18 23:02:25,838 INFO Processing conversation 1499/1505
2024-09-18 23:02:25,859 INFO Input sequence length: torch.Size([1, 7061])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 9306.170834029619
*****************************************************************************************************************
2024-09-18 23:12:08,612 INFO User 18502 processed in 582.77s
2024-09-18 23:12:08,615 INFO Processing conversation 1500/1505
2024-09-18 23:12:08,643 INFO Input sequence length: torch.Size([1, 13341])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 7405.216543312688
*****************************************************************************************************************
2024-09-18 23:12:17,819 ERROR Exception in conversation user 18497: CUDA out of memory. Tried to allocate 3.19 GiB. GPU
2024-09-18 23:12:17,819 ERROR Attempt 1/3 failed
2024-09-18 23:12:18,852 INFO Input sequence length: torch.Size([1, 13341])
2024-09-18 23:12:28,098 ERROR Exception in conversation user 18497: CUDA out of memory. Tried to allocate 3.19 GiB. GPU
2024-09-18 23:12:28,098 ERROR Attempt 2/3 failed
2024-09-18 23:12:29,130 INFO Input sequence length: torch.Size([1, 13341])
2024-09-18 23:12:38,450 ERROR Exception in conversation user 18497: CUDA out of memory. Tried to allocate 3.19 GiB. GPU
2024-09-18 23:12:38,451 ERROR Attempt 3/3 failed
2024-09-18 23:12:38,451 ERROR Failed to process conversation user 18497 after 3 attempts
2024-09-18 23:12:38,452 INFO Processing conversation 1501/1505
2024-09-18 23:12:38,469 INFO Input sequence length: torch.Size([1, 7229])
2024-09-18 23:17:46,999 INFO User 18505 processed in 308.55s
2024-09-18 23:17:47,002 INFO Processing conversation 1502/1505
2024-09-18 23:17:47,033 INFO Input sequence length: torch.Size([1, 15045])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 4454.737931868881
*****************************************************************************************************************
2024-09-18 23:17:57,381 ERROR Exception in conversation user 18498: CUDA out of memory. Tried to allocate 3.60 GiB. GPU
2024-09-18 23:17:57,382 ERROR Attempt 1/3 failed
2024-09-18 23:17:58,415 INFO Input sequence length: torch.Size([1, 15045])
2024-09-18 23:18:08,958 ERROR Exception in conversation user 18498: CUDA out of memory. Tried to allocate 3.60 GiB. GPU
2024-09-18 23:18:08,958 ERROR Attempt 2/3 failed
2024-09-18 23:18:09,999 INFO Input sequence length: torch.Size([1, 15045])
2024-09-18 23:18:20,786 ERROR Exception in conversation user 18498: CUDA out of memory. Tried to allocate 3.60 GiB. GPU
2024-09-18 23:18:20,787 ERROR Attempt 3/3 failed
2024-09-18 23:18:20,787 ERROR Failed to process conversation user 18498 after 3 attempts
2024-09-18 23:18:20,788 INFO Processing conversation 1503/1505
2024-09-18 23:18:20,800 INFO Input sequence length: torch.Size([1, 5781])
2024-09-18 23:24:30,525 INFO User 18500 processed in 369.74s
2024-09-18 23:24:30,530 INFO Processing conversation 1504/1505
2024-09-18 23:24:30,548 INFO Input sequence length: torch.Size([1, 7557])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 5074.819636737247
*****************************************************************************************************************
2024-09-18 23:35:47,893 ERROR Exception in conversation user 18501: The length doesn't match between the generated and reference trajectories.
2024-09-18 23:35:47,893 ERROR Attempt 1/3 failed
**************************************************Result Report**************************************************
2024-09-18 23:35:48,917 INFO Input sequence length: torch.Size([1, 7557])
2024-09-18 23:41:10,470 ERROR Exception in conversation user 18501: The length doesn't match between the generated and reference trajectories.
2024-09-18 23:41:10,470 ERROR Attempt 2/3 failed
**************************************************Result Report**************************************************
2024-09-18 23:41:11,492 INFO Input sequence length: torch.Size([1, 7557])
2024-09-18 23:45:08,137 ERROR Exception in conversation user 18501: The length doesn't match between the generated and reference trajectories.
2024-09-18 23:45:08,137 ERROR Attempt 3/3 failed
2024-09-18 23:45:08,137 ERROR Failed to process conversation user 18501 after 3 attempts
2024-09-18 23:45:08,138 INFO Processing conversation 1505/1505
2024-09-18 23:45:08,148 INFO Input sequence length: torch.Size([1, 6357])
**************************************************Result Report**************************************************
**************************************************Result Report**************************************************
2024-09-18 23:47:23,864 INFO User 18503 processed in 135.73s
2024-09-18 23:47:23,866 INFO Failed conversations: [18497, 18498, 18501]
geobleu: 0.0
dtw: 6564.681885208706
*****************************************************************************************************************
2024-09-18 23:47:24,412 INFO Saving results to generated_datasetC_test_17000-19999_range(1496, 1506).csv.gz
2024-09-18 23:47:24,414 INFO Results saved to generated_datasetC_test_17000-19999_range(1496, 1506).csv.gz