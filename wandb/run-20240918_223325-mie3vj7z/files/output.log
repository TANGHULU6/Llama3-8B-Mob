
2024-09-18 22:33:28,953 INFO Initializing model and tokenizer...
==((====))==  Unsloth: Fast Llama patching release 2024.7
   \\   /|    GPU: NVIDIA RTX A6000. Max memory: 47.536 GB. Platform = Linux.
O^O/ \_/ \    Pytorch: 2.3.0+cu121. CUDA = 8.6. CUDA Toolkit = 12.1.
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.26.post1. FA2 = False]
 "-____-"     Free Apache license: http://github.com/unslothai/unsloth
Unsloth: unsloth/llama-3-8b-Instruct-bnb-4bit can only handle sequence lengths of at most 8192.
But with kaiokendev's RoPE scaling of 6.104, it can be magically be extended to 50000!
Unsloth 2024.7 patched 32 layers with 32 QKV layers, 32 O layers and 32 MLP layers.
2024-09-18 22:33:38,210 INFO Model and tokenizer initialized successfully.
2024-09-18 22:33:38,211 INFO Starting inference from index 20 to 29 on dataset datasetC_test_17000-19999.json
2024-09-18 22:33:38,211 INFO Loading dataset from datasetC_test_17000-19999.json...
2024-09-18 22:33:38,887 INFO Dataset loaded with 3000 conversations.
2024-09-18 22:33:38,890 INFO Loaded dataset datasetC_test_17000-19999.json with 3000 conversations
2024-09-18 22:33:38,891 INFO Selected subset of dataset from index 20 to 30
Map: 100%|██████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 431.63 examples/s]
2024-09-18 22:33:38,919 INFO Applied formatting prompts function to dataset
2024-09-18 22:33:38,919 INFO Total conversations to process: 10
2024-09-18 22:33:38,920 INFO Processing conversation 20/29
2024-09-18 22:33:38,946 INFO Input sequence length: torch.Size([1, 8837])
2024-09-18 22:41:08,753 INFO User 17020 processed in 449.83s
2024-09-18 22:41:08,758 INFO Processing conversation 21/29
2024-09-18 22:41:08,772 INFO Input sequence length: torch.Size([1, 6357])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 9783.364980367287
*****************************************************************************************************************
2024-09-18 22:49:08,043 INFO User 17024 processed in 479.28s
2024-09-18 22:49:08,047 INFO Processing conversation 22/29
2024-09-18 22:49:08,074 INFO Input sequence length: torch.Size([1, 10701])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6589.1334481706745
*****************************************************************************************************************
**************************************************Result Report**************************************************
2024-09-18 23:11:51,996 INFO User 17026 processed in 1363.95s
2024-09-18 23:11:51,999 INFO Processing conversation 23/29
2024-09-18 23:11:52,023 INFO Input sequence length: torch.Size([1, 8189])
geobleu: 2.8043700888543236e-283
dtw: 12991.701063311293
*****************************************************************************************************************
**************************************************Result Report**************************************************
2024-09-18 23:22:40,554 INFO User 17022 processed in 648.56s
2024-09-18 23:22:40,557 INFO Processing conversation 24/29
2024-09-18 23:22:40,587 INFO Input sequence length: torch.Size([1, 8181])
geobleu: 0.0
dtw: 7722.030544642274
*****************************************************************************************************************
2024-09-18 23:32:39,798 INFO User 17021 processed in 599.24s
2024-09-18 23:32:39,803 INFO Processing conversation 25/29
2024-09-18 23:32:39,821 INFO Input sequence length: torch.Size([1, 5685])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 7133.18345374978
*****************************************************************************************************************
2024-09-18 23:37:02,611 ERROR Exception in conversation user 17025: The length doesn't match between the generated and reference trajectories.
2024-09-18 23:37:02,611 ERROR Attempt 1/3 failed
**************************************************Result Report**************************************************
2024-09-18 23:37:03,631 INFO Input sequence length: torch.Size([1, 5685])
2024-09-18 23:41:21,253 INFO User 17025 processed in 521.45s
2024-09-18 23:41:21,258 INFO Processing conversation 26/29
2024-09-18 23:41:21,276 INFO Input sequence length: torch.Size([1, 4493])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 3637.531279892363
*****************************************************************************************************************
2024-09-18 23:45:41,030 INFO User 17023 processed in 259.77s
2024-09-18 23:45:41,035 INFO Processing conversation 27/29
2024-09-18 23:45:41,050 INFO Input sequence length: torch.Size([1, 7173])
**************************************************Result Report**************************************************
geobleu: 3.0153801951557826e-283
dtw: 3929.0171409980635
*****************************************************************************************************************
2024-09-18 23:53:25,126 INFO User 17027 processed in 464.09s
2024-09-18 23:53:25,131 INFO Processing conversation 28/29
2024-09-18 23:53:25,148 INFO Input sequence length: torch.Size([1, 4245])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 5950.872556869553
*****************************************************************************************************************
2024-09-18 23:56:36,469 INFO User 17028 processed in 191.34s
2024-09-18 23:56:36,474 INFO Processing conversation 29/29
2024-09-18 23:56:36,487 INFO Input sequence length: torch.Size([1, 6317])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 4204.177211898241
*****************************************************************************************************************
2024-09-19 00:02:07,436 INFO User 17029 processed in 330.96s
2024-09-19 00:02:07,438 INFO Failed conversations: []
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 5916.968903154056
*****************************************************************************************************************
2024-09-19 00:02:08,019 INFO Saving results to generated_datasetC_test_17000-19999_range(20, 30).csv.gz
2024-09-19 00:02:08,025 INFO Results saved to generated_datasetC_test_17000-19999_range(20, 30).csv.gz