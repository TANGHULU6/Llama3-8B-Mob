
2024-09-18 22:50:45,983 INFO Initializing model and tokenizer...
==((====))==  Unsloth: Fast Llama patching release 2024.7
   \\   /|    GPU: NVIDIA RTX A6000. Max memory: 47.536 GB. Platform = Linux.
O^O/ \_/ \    Pytorch: 2.3.0+cu121. CUDA = 8.6. CUDA Toolkit = 12.1.
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.26.post1. FA2 = False]
 "-____-"     Free Apache license: http://github.com/unslothai/unsloth
Unsloth: unsloth/llama-3-8b-Instruct-bnb-4bit can only handle sequence lengths of at most 8192.
But with kaiokendev's RoPE scaling of 6.104, it can be magically be extended to 50000!
Unsloth 2024.7 patched 32 layers with 32 QKV layers, 32 O layers and 32 MLP layers.
2024-09-18 22:51:06,338 INFO Model and tokenizer initialized successfully.
2024-09-18 22:51:06,340 INFO Starting inference from index 1424 to 1433 on dataset datasetC_test_17000-19999.json
2024-09-18 22:51:06,341 INFO Loading dataset from datasetC_test_17000-19999.json...
2024-09-18 22:51:07,269 INFO Dataset loaded with 3000 conversations.
2024-09-18 22:51:07,272 INFO Loaded dataset datasetC_test_17000-19999.json with 3000 conversations
2024-09-18 22:51:07,274 INFO Selected subset of dataset from index 1424 to 1434
Map: 100%|██████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 270.29 examples/s]
2024-09-18 22:51:07,317 INFO Applied formatting prompts function to dataset
2024-09-18 22:51:07,317 INFO Total conversations to process: 10
2024-09-18 22:51:07,318 INFO Processing conversation 1424/1433
2024-09-18 22:51:07,341 INFO Input sequence length: torch.Size([1, 5733])
2024-09-18 22:55:01,389 INFO User 18416 processed in 234.07s
2024-09-18 22:55:01,394 INFO Processing conversation 1425/1433
2024-09-18 22:55:01,420 INFO Input sequence length: torch.Size([1, 9325])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 4694.683507682735
*****************************************************************************************************************
2024-09-18 22:57:22,616 INFO User 18424 processed in 141.22s
2024-09-18 22:57:22,620 INFO Processing conversation 1426/1433
2024-09-18 22:57:22,640 INFO Input sequence length: torch.Size([1, 6653])
**************************************************Result Report**************************************************
geobleu: 3.618029351551095e-282
dtw: 2679.563949316464
*****************************************************************************************************************
2024-09-18 23:04:10,804 ERROR Exception in conversation user 18429: The length doesn't match between the generated and reference trajectories.
2024-09-18 23:04:10,804 ERROR Attempt 1/3 failed
**************************************************Result Report**************************************************
2024-09-18 23:04:11,828 INFO Input sequence length: torch.Size([1, 6653])
**************************************************Result Report**************************************************
2024-09-18 23:11:58,321 INFO User 18429 processed in 875.70s
2024-09-18 23:11:58,326 INFO Processing conversation 1427/1433
2024-09-18 23:11:58,343 INFO Input sequence length: torch.Size([1, 7085])
geobleu: 0.0
dtw: 8666.532899504684
*****************************************************************************************************************
2024-09-18 23:18:03,069 INFO User 18427 processed in 364.74s
2024-09-18 23:18:03,073 INFO Processing conversation 1428/1433
2024-09-18 23:18:03,096 INFO Input sequence length: torch.Size([1, 8141])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6748.5164195945845
*****************************************************************************************************************
**************************************************Result Report**************************************************
2024-09-18 23:23:37,024 INFO User 18426 processed in 333.95s
2024-09-18 23:23:37,028 INFO Processing conversation 1429/1433
2024-09-18 23:23:37,048 INFO Input sequence length: torch.Size([1, 6693])
geobleu: 3.2771007559211236e-281
dtw: 5401.449034638975
*****************************************************************************************************************
2024-09-18 23:30:49,848 INFO User 18430 processed in 432.82s
2024-09-18 23:30:49,852 INFO Processing conversation 1430/1433
2024-09-18 23:30:49,875 INFO Input sequence length: torch.Size([1, 6037])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 7796.415972784784
*****************************************************************************************************************
2024-09-18 23:34:59,941 INFO User 18433 processed in 250.09s
2024-09-18 23:34:59,947 INFO Processing conversation 1431/1433
2024-09-18 23:34:59,962 INFO Input sequence length: torch.Size([1, 6997])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 5394.232774996082
*****************************************************************************************************************
**************************************************Result Report**************************************************
2024-09-18 23:40:10,010 INFO User 18428 processed in 310.06s
2024-09-18 23:40:10,015 INFO Processing conversation 1432/1433
2024-09-18 23:40:10,032 INFO Input sequence length: torch.Size([1, 4549])
geobleu: 0.0
dtw: 8425.229990182124
*****************************************************************************************************************
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6210.23053763289
*****************************************************************************************************************
2024-09-18 23:43:31,728 INFO User 18434 processed in 201.71s
2024-09-18 23:43:31,731 INFO Processing conversation 1433/1433
2024-09-18 23:43:31,752 INFO Input sequence length: torch.Size([1, 5765])
**************************************************Result Report**************************************************
2024-09-18 23:47:18,365 INFO User 18435 processed in 226.63s
2024-09-18 23:47:18,366 INFO Failed conversations: []
geobleu: 0.0
dtw: 7287.413594674448
*****************************************************************************************************************
2024-09-18 23:47:18,906 INFO Saving results to generated_datasetC_test_17000-19999_range(1424, 1434).csv.gz
2024-09-18 23:47:18,912 INFO Results saved to generated_datasetC_test_17000-19999_range(1424, 1434).csv.gz