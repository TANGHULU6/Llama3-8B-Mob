
2024-09-18 22:37:25,555 INFO Initializing model and tokenizer...
==((====))==  Unsloth: Fast Llama patching release 2024.7
   \\   /|    GPU: NVIDIA RTX A6000. Max memory: 47.536 GB. Platform = Linux.
O^O/ \_/ \    Pytorch: 2.3.0+cu121. CUDA = 8.6. CUDA Toolkit = 12.1.
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.26.post1. FA2 = False]
 "-____-"     Free Apache license: http://github.com/unslothai/unsloth
Unsloth: unsloth/llama-3-8b-Instruct-bnb-4bit can only handle sequence lengths of at most 8192.
But with kaiokendev's RoPE scaling of 6.104, it can be magically be extended to 50000!
Unsloth 2024.7 patched 32 layers with 32 QKV layers, 32 O layers and 32 MLP layers.
2024-09-18 22:37:43,797 INFO Model and tokenizer initialized successfully.
2024-09-18 22:37:43,798 INFO Starting inference from index 416 to 425 on dataset datasetC_test_17000-19999.json
2024-09-18 22:37:43,798 INFO Loading dataset from datasetC_test_17000-19999.json...
2024-09-18 22:37:44,565 INFO Dataset loaded with 3000 conversations.
2024-09-18 22:37:44,568 INFO Loaded dataset datasetC_test_17000-19999.json with 3000 conversations
2024-09-18 22:37:44,569 INFO Selected subset of dataset from index 416 to 426
Map: 100%|██████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 406.80 examples/s]
2024-09-18 22:37:44,598 INFO Applied formatting prompts function to dataset
2024-09-18 22:37:44,598 INFO Total conversations to process: 10
2024-09-18 22:37:44,599 INFO Processing conversation 416/425
2024-09-18 22:37:44,612 INFO Input sequence length: torch.Size([1, 5869])
2024-09-18 22:44:59,978 INFO User 17411 processed in 435.38s
2024-09-18 22:44:59,981 INFO Processing conversation 417/425
2024-09-18 22:45:00,001 INFO Input sequence length: torch.Size([1, 5237])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6361.699293022192
*****************************************************************************************************************
2024-09-18 22:50:31,811 INFO User 17417 processed in 331.83s
2024-09-18 22:50:31,815 INFO Processing conversation 418/425
2024-09-18 22:50:31,840 INFO Input sequence length: torch.Size([1, 11677])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 4746.365673113846
*****************************************************************************************************************
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 7878.336735731584
*****************************************************************************************************************
2024-09-18 23:04:11,834 INFO User 17418 processed in 820.02s
2024-09-18 23:04:11,839 INFO Processing conversation 419/425
2024-09-18 23:04:11,857 INFO Input sequence length: torch.Size([1, 5589])
2024-09-18 23:12:02,767 INFO User 17425 processed in 470.93s
2024-09-18 23:12:02,772 INFO Processing conversation 420/425
2024-09-18 23:12:02,796 INFO Input sequence length: torch.Size([1, 6645])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6469.1729913933395
*****************************************************************************************************************
2024-09-18 23:22:12,522 INFO User 17422 processed in 609.75s
2024-09-18 23:22:12,527 INFO Processing conversation 421/425
2024-09-18 23:22:12,549 INFO Input sequence length: torch.Size([1, 9349])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 7823.4512604909005
*****************************************************************************************************************
2024-09-18 23:34:44,921 INFO User 17419 processed in 752.39s
2024-09-18 23:34:44,925 INFO Processing conversation 422/425
2024-09-18 23:34:44,938 INFO Input sequence length: torch.Size([1, 4461])
**************************************************Result Report**************************************************
geobleu: 1.881586498633624e-280
dtw: 8207.940116327352
*****************************************************************************************************************
2024-09-18 23:38:25,149 ERROR Exception in conversation user 17421: The length doesn't match between the generated and reference trajectories.
2024-09-18 23:38:25,149 ERROR Attempt 1/3 failed
**************************************************Result Report**************************************************
2024-09-18 23:38:26,168 INFO Input sequence length: torch.Size([1, 4461])
2024-09-18 23:42:07,752 ERROR Exception in conversation user 17421: The length doesn't match between the generated and reference trajectories.
2024-09-18 23:42:07,752 ERROR Attempt 2/3 failed
**************************************************Result Report**************************************************
2024-09-18 23:42:08,769 INFO Input sequence length: torch.Size([1, 4461])
2024-09-18 23:45:51,113 ERROR Exception in conversation user 17421: The length doesn't match between the generated and reference trajectories.
2024-09-18 23:45:51,113 ERROR Attempt 3/3 failed
2024-09-18 23:45:51,113 ERROR Failed to process conversation user 17421 after 3 attempts
2024-09-18 23:45:51,114 INFO Processing conversation 423/425
2024-09-18 23:45:51,133 INFO Input sequence length: torch.Size([1, 7565])
**************************************************Result Report**************************************************
2024-09-18 23:54:05,863 INFO User 17424 processed in 494.75s
2024-09-18 23:54:05,868 INFO Processing conversation 424/425
2024-09-18 23:54:05,894 INFO Input sequence length: torch.Size([1, 9981])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 6275.302911572691
*****************************************************************************************************************
2024-09-19 00:05:11,363 INFO User 17423 processed in 665.50s
2024-09-19 00:05:11,368 INFO Processing conversation 425/425
2024-09-19 00:05:11,381 INFO Input sequence length: torch.Size([1, 5109])
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 11661.516393258242
*****************************************************************************************************************
**************************************************Result Report**************************************************
geobleu: 0.0
dtw: 4498.303123378247
*****************************************************************************************************************
2024-09-19 00:06:29,785 INFO User 17420 processed in 78.42s
2024-09-19 00:06:29,789 INFO Failed conversations: [17421]
2024-09-19 00:06:30,343 INFO Saving results to generated_datasetC_test_17000-19999_range(416, 426).csv.gz
2024-09-19 00:06:30,346 INFO Results saved to generated_datasetC_test_17000-19999_range(416, 426).csv.gz